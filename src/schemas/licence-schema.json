{
  "schema": "WFSL-Licence-CE-v1.0",
  "version": "1.0.0",
  "description": "WFSL Commercial Edition licence schema for controlled software distribution.",

  "fields": {
    "licenceId": {
      "type": "string",
      "required": true,
      "description": "Unique identifier for this licence instance."
    },
    "customer": {
      "type": "string",
      "required": true,
      "description": "Customer or organisation the licence is issued to."
    },
    "issuedAt": {
      "type": "string",
      "format": "ISO8601",
      "required": true,
      "description": "Timestamp when the licence is generated."
    },
    "expiresAt": {
      "type": "string",
      "format": "ISO8601",
      "required": false,
      "description": "Optional expiry timestamp."
    },
    "machineId": {
      "type": "string",
      "required": true,
      "description": "SHA256 machine identifier captured at issue time."
    },
    "product": {
      "type": "string",
      "required": true,
      "description": "Product the licence applies to."
    },
    "edition": {
      "type": "string",
      "required": true,
      "allowed": ["CE", "PRO", "ENT"],
      "description": "Edition tier of the licence."
    },
    "metadata": {
      "type": "object",
      "required": false,
      "description": "Optional metadata for customer or deployment information."
    },
    "hash": {
      "type": "string",
      "required": true,
      "description": "Hash of the licence before signing."
    },
    "signature": {
      "type": "string",
      "required": true,
      "description": "RSA signature for licence integrity."
    }
  },

  "integrity": {
    "tamperFields": [
      "licenceId",
      "customer",
      "issuedAt",
      "machineId",
      "product"
    ],
    "hashAlgorithm": "SHA256",
    "signatureAlgorithm": "RSA4096-PKCS1"
  }
}
